# Wine Quality Prediction with PySpark & MLflow

μ΄ ν”„λ΅μ νΈλ” PySparkμ™€ MLflowλ¥Ό μ‚¬μ©ν•μ—¬ μ™€μΈ ν’μ§ μμΈ΅ λ¨λΈμ„ ν•™μµν•κ³  κ΄€λ¦¬ν•λ” λ¨Έμ‹ λ¬λ‹ ν”„λ΅μ νΈμ…λ‹λ‹¤.

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
wine/
β”β”€β”€ wine_pyspark.py              # λ©”μΈ ν•™μµ μ¤ν¬λ¦½νΈ
β”β”€β”€ wine_quality_merged.csv      # μ™€μΈ ν’μ§ λ°μ΄ν„°μ…‹
β”β”€β”€ docker-compose.yml           # Docker Compose μ„¤μ •
β”β”€β”€ Dockerfile.mlflow            # MLflow UIμ© Dockerfile
β”β”€β”€ Dockerfile.training          # ν•™μµμ© Dockerfile
β”β”€β”€ requirements.txt             # Python μμ΅΄μ„±
β”β”€β”€ run.sh                       # λ΅μ»¬ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”β”€β”€ mlruns/                      # MLflow μ‹¤ν— κ²°κ³Ό μ €μ¥μ†
β””β”€β”€ README.md                    # ν”„λ΅μ νΈ λ¬Έμ„
```

## π€ λΉ λ¥Έ μ‹μ‘

### Docker Compose μ‚¬μ© (κ¶μ¥)

1. **λ¨λ“  μ„λΉ„μ¤ μ‹¤ν–‰ (MLflow UI + ν•™μµ)**
   ```bash
   docker-compose up -d
   ```

2. **MLflow UIλ§ μ‹¤ν–‰**
   ```bash
   docker-compose up -d mlflow-ui
   ```

3. **ν•™μµλ§ μ‹¤ν–‰**
   ```bash
   docker-compose up training
   ```

4. **MLflow UI μ ‘μ†**
   - λΈλΌμ°μ €μ—μ„ http://localhost:5000 μ ‘μ†
   - μ‹¤ν— κ²°κ³Ό, λ¨λΈ, λ©”νΈλ¦­ ν™•μΈ κ°€λ¥

### λ΅μ»¬ μ‹¤ν–‰

```bash
# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt

# ν•™μµ μ‹¤ν–‰
python wine_pyspark.py

# MLflow UI μ‹¤ν–‰
mlflow ui --host 0.0.0.0 --port 5000
```

## π§  λ¨λΈ μ •λ³΄

### μ‚¬μ©λ μ•κ³ λ¦¬μ¦
- **Neural Network (MultilayerPerceptronClassifier)**
- **Naive Bayes**
- **Logistic Regression**

### λ°μ΄ν„° μ „μ²λ¦¬
- λΌλ²¨ μ¬λ¶„λ¥: ν’μ§ 3-5 β†’ 0 (λ‚®μ), 6-9 β†’ 1 (λ†’μ)
- νΉμ„± λ²΅ν„°ν™” λ° μ •κ·ν™”
- κµμ°¨ κ²€μ¦μ„ ν†µν• ν•μ΄νΌνλΌλ―Έν„° νλ‹

### ν‰κ°€ λ©”νΈλ¦­
- **Accuracy**: μ •ν™•λ„
- **F1-score**: F1 μ μ

## π“ μ‹¤ν— κ΄€λ¦¬

### MLflow κΈ°λ¥
- **μ‹¤ν— μ¶”μ **: κ° μ‹¤ν–‰μ νλΌλ―Έν„°, λ©”νΈλ¦­, μ•„ν‹°ν©νΈ μ €μ¥
- **λ¨λΈ λ²„μ „ κ΄€λ¦¬**: μµμ  λ¨λΈ μλ™ λ“±λ΅
- **λΉ„κµ λ¶„μ„**: μ—¬λ¬ λ¨λΈ μ„±λ¥ λΉ„κµ
- **μ¬ν„μ„±**: μ‹¤ν— ν™κ²½ λ° μ½”λ“ λ²„μ „ κ΄€λ¦¬

### μ‹¤ν— κ²°κ³Ό ν™•μΈ
1. http://localhost:5000 μ ‘μ†
2. "WineQualityExperiment" μ‹¤ν— μ„ νƒ
3. κ° μ‹¤ν–‰μ μƒμ„Έ μ •λ³΄ ν™•μΈ
4. λ¨λΈ μ„±λ¥ λΉ„κµ λ° μµμ  λ¨λΈ μ„ νƒ

## π³ Docker μ„λΉ„μ¤ κµ¬μ„±

### mlflow-ui
- **ν¬νΈ**: 5000
- **κΈ°λ¥**: MLflow μ›Ή μΈν„°νμ΄μ¤
- **λ³Όλ¥¨**: `./mlruns:/app/mlruns`

### training
- **κΈ°λ¥**: λ¨λΈ ν•™μµ λ° μ‹¤ν— μ‹¤ν–‰
- **λ³Όλ¥¨**: 
  - `./mlruns:/app/mlruns` (μ‹¤ν— κ²°κ³Ό μ €μ¥)
  - `./wine_quality_merged.csv:/app/wine_quality_merged.csv` (λ°μ΄ν„°)

## π“ μ‹¤ν— κ²°κ³Ό μμ‹

```
Best Params: {'maxIter': 50, 'blockSize': 64}
Accuracy: 0.6436041834271923
F1-score: 0.5040463502121917
```

## π”§ κ°λ° ν™κ²½

- **Python**: 3.9+
- **PySpark**: 3.5.0
- **MLflow**: 2.7.0
- **Docker**: 20.10+
- **Docker Compose**: 2.0+

## π“ μ£Όμ” κΈ°λ¥

1. **μλ™ν™”λ μ‹¤ν—**: μ—¬λ¬ μ•κ³ λ¦¬μ¦ μλ™ ν•™μµ λ° λΉ„κµ
2. **ν•μ΄νΌνλΌλ―Έν„° νλ‹**: κµμ°¨ κ²€μ¦μ„ ν†µν• μµμ  νλΌλ―Έν„° νƒμƒ‰
3. **λ¨λΈ λ²„μ „ κ΄€λ¦¬**: μµμ  λ¨λΈ μλ™ λ“±λ΅ λ° κ΄€λ¦¬
4. **μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§**: MLflow UIλ¥Ό ν†µν• μ‹¤ν— μ§„ν–‰ μƒν™© ν™•μΈ
5. **μ¬ν„ κ°€λ¥ν• μ‹¤ν—**: Dockerλ¥Ό ν†µν• μΌκ΄€λ ν™κ²½ μ κ³µ

## π¨ λ¬Έμ  ν•΄κ²°

### Docker κ΄€λ ¨ μ¤λ¥
- Docker Desktopμ΄ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
- `docker-compose down` ν›„ `docker-compose up -d --build` μ¬μ‹¤ν–‰

### MLflow UI μ ‘μ† λ¶κ°€
- ν¬νΈ 5000μ΄ μ‚¬μ© μ¤‘μΈμ§€ ν™•μΈ
- λ°©ν™”λ²½ μ„¤μ • ν™•μΈ

### λ°μ΄ν„°λ² μ΄μ¤ μ¤λ¥
- μ΄κΈ° μ‹¤ν–‰ μ‹ μ •μƒμ μΈ ν„μƒ
- μ‹¤ν— μ‹¤ν–‰ ν›„ μλ™μΌλ΅ ν•΄κ²°λ¨

## π“ μ§€μ›

λ¬Έμ κ°€ λ°μƒν•λ©΄ λ‹¤μμ„ ν™•μΈν•μ„Έμ”:
1. Docker Desktop μ‹¤ν–‰ μƒνƒ
2. ν¬νΈ 5000 μ‚¬μ© κ°€λ¥ μ—¬λ¶€
3. `mlruns` ν΄λ” κ¶ν• μ„¤μ •